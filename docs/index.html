<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>rom-scout - Interactive Demo & Documentation</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="build-badge" data-build-time="__BUILD_TIME__"></div>
  <header>
    <div class="container">
      <h1>rom-scout</h1>
      <p class="tagline">ROM identification and metadata fetching library</p>
      <div class="links">
        <a href="player.html">ROM Player Demo</a>
        <a href="https://github.com/jburnhams/rom-scout" target="_blank">GitHub</a>
        <a href="https://www.npmjs.com/package/rom-scout" target="_blank">npm</a>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="intro">
      <h2>Interactive Demo</h2>
      <p>
        This page demonstrates the rom-scout library with interactive examples.
        Each example includes runnable code that you can test with the included ROM files:
        <strong>Pac-Man</strong> (Arcade) and <strong>Sonic the Hedgehog</strong> (Master System).
      </p>
      <p>
        <strong>Installation:</strong> <code>npm install rom-scout</code>
      </p>
    </section>

    <!-- Example 1: Hash Calculation -->
    <section class="example">
      <h3>1. Calculate ROM Hashes</h3>
      <p>
        Calculate MD5, SHA-1, and CRC32 hashes for any ROM file. This works entirely client-side without any API calls.
      </p>

      <div class="code-block">
        <div class="code-header">
          <span>JavaScript</span>
          <button class="run-btn" data-example="hash">Run Example</button>
        </div>
        <pre><code>import { RomScout } from 'rom-scout';

// Create a scout instance (no API needed for hashing)
const scout = new RomScout();

// Load a ROM file (in browser from file input)
const fileInput = document.getElementById('rom-file');
const file = fileInput.files[0];

// Calculate hashes
const hashes = await scout.hash(file);

console.log('MD5:', hashes.md5);
console.log('SHA-1:', hashes.sha1);
console.log('CRC32:', hashes.crc32);</code></pre>
      </div>

      <div class="demo-area">
        <div class="file-info" data-result="result-hash">
          <label>
            <strong>Select ROM:</strong>
            <select class="rom-select">
              <option value="pacman">Pac-Man (pacman.zip)</option>
              <option value="sonic">Sonic the Hedgehog (sonic.bin)</option>
            </select>
          </label>
        </div>
        <div id="result-hash" class="result"></div>
      </div>
    </section>

    <!-- Example 2: Hasheous API -->
    <section class="example">
      <h3>2. Hasheous API - Hash-based Lookup</h3>
      <p>
        Fetch metadata from a Hasheous server using ROM hashes.
        <a href="https://github.com/Hasheous/Hasheous" target="_blank">Hasheous</a> is an open-source ROM metadata server.
      </p>

      <div class="code-block">
        <div class="code-header">
          <span>JavaScript</span>
          <button class="run-btn" data-example="hasheous">Run Example</button>
        </div>
        <pre><code>import { RomScout } from 'rom-scout';

// Create a scout instance with Hasheous
const scout = new RomScout({
  provider: 'hasheous',
  hasheousUrl: 'https://your-hasheous-instance.com'
});

// Load a ROM file
const file = document.getElementById('rom-file').files[0];

// Identify the ROM and fetch metadata
const metadata = await scout.identify(file);

if (metadata) {
  console.log('Title:', metadata.title);
  console.log('Platform:', metadata.platform);
  console.log('Publisher:', metadata.publisher);

  // Display cover art if available
  if (metadata.images && metadata.images.length > 0) {
    console.log('Cover:', metadata.images[0].url);
  }
}</code></pre>
      </div>

      <div class="demo-area">
        <div class="api-config">
          <label>
            Hasheous URL:
            <input
              type="text"
              id="hasheous-url"
              value="https://hasheous.org"
              placeholder="https://hasheous.org"
              class="api-input"
            >
          </label>
          <div class="config-note">
            <strong>Note:</strong> Using the free public instance at
            <a href="https://hasheous.org" target="_blank">hasheous.org</a>.
            You can also <a href="https://github.com/gaseous-project/hasheous" target="_blank">self-host</a>
            your own instance.<br>
            <em>On GitHub Pages, a CORS proxy is automatically used to bypass browser restrictions.</em>
          </div>
        </div>
        <div class="file-info" data-result="result-hasheous">
          <label>
            <strong>Select ROM:</strong>
            <select class="rom-select" id="hasheous-rom-select">
              <option value="pacman">Pac-Man (pacman.zip)</option>
              <option value="sonic">Sonic the Hedgehog (sonic.bin)</option>
              <option value="custom">Custom File...</option>
            </select>
          </label>
          <label id="hasheous-custom-file" style="display: none; margin-top: 0.5rem;">
            <strong>Choose your ROM file:</strong>
            <input type="file" id="hasheous-file-input" accept=".zip,.bin,.nes,.snes,.gba,.gb,.gbc,.smd,.md,.gen,.sms,.gg" class="file-input">
          </label>
        </div>
        <div id="result-hasheous" class="result"></div>
      </div>
    </section>

    <!-- Example 3: Extensibility -->
    <section class="example">
      <h3>3. Extensibility Hooks</h3>
      <p>
        The <code>lookupMultiple</code> helper is available for future multi-provider setups.
        Today it simply wraps the Hasheous lookup so you can plug in your own providers later.
      </p>

      <div class="code-block">
        <div class="code-header">
          <span>JavaScript</span>
        </div>
        <pre><code>import { RomScout } from 'rom-scout';

// Configure Hasheous (additional providers can be added in the future)
const scout = new RomScout({
  hasheousUrl: 'https://your-hasheous-instance.com'
});

// Load a ROM file
const file = document.getElementById('rom-file').files[0];

// Calculate hashes first
const hashes = await scout.hash(file);

// Create lookup request
const request = {
  md5: hashes.md5,
  sha1: hashes.sha1,
  crc32: hashes.crc32,
  filename: file.name
};

// Try providers in order (currently only Hasheous)
const metadata = await scout.lookupMultiple(
  request,
  ['hasheous']
);

if (metadata) {
  console.log('Found in:', metadata.source);
  console.log('Title:', metadata.title);
}</code></pre>
      </div>
    </section>

    <!-- Installation & Usage -->
    <section class="example">
      <h3>Installation & Usage</h3>

      <h4>Node.js / npm</h4>
      <div class="code-block">
        <pre><code>npm install rom-scout</code></pre>
      </div>

      <div class="code-block">
        <pre><code>import { RomScout } from 'rom-scout';
import { readFileSync } from 'fs';

const scout = new RomScout({
  provider: 'hasheous',
  hasheousUrl: 'https://your-hasheous-instance.com'
});

const romData = readFileSync('pacman.zip');
const metadata = await scout.identify(romData, 'pacman.zip');
console.log(metadata);</code></pre>
      </div>

      <h4>Browser / CDN</h4>
      <div class="code-block">
        <pre><code>&lt;script type="module"&gt;
  import { RomScout } from 'https://unpkg.com/rom-scout/dist/bundles/rom-scout.esm.js';

  const scout = new RomScout();
  // Use scout...
&lt;/script&gt;</code></pre>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <p>
        rom-scout is open source software licensed under MIT.
        <a href="https://github.com/jburnhams/rom-scout" target="_blank">View on GitHub</a>
      </p>
    </div>
  </footer>
  <script type="module" src="build-info.js"></script>
  <script type="module" src="demo.js"></script>
</body>
</html>
